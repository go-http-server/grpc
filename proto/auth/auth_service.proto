syntax = "proto3";

import "buf/validate/validate.proto";

option go_package = "/protoc";

message LoginRequest {
  // username must be 3-32 characters long, can only contain letters, numbers, and underscores
  string username = 1 [
    (buf.validate.field).required = true,
    (buf.validate.field).string = { min_len: 6, max_len: 32, pattern: "^[A-Za-z0-9_]+$" }
  ];
  // password must be 6-30 characters long, must contain at least one uppercase letter and one special character
  string password = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string = { min_len: 6, max_len: 30, pattern: "[A-Za-z0-9_]+$" }
  ];
}

message LoginResponse {
  string access_token = 1;
}

service AuthService {
  // Login to the system
  rpc Login(LoginRequest) returns (LoginResponse) {};
}
